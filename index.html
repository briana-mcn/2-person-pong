<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>PONG</title>
    <style>
        canvas { background: aliceblue; display: block; margin: 0 auto; }
    </style>
</head>
<body>

<canvas id="myCanvas" width="860" height="550"></canvas>

<script>
//create full scale canvas
//draw ball
//move ball
const canvas = document.querySelector('#myCanvas');
const ctx = canvas.getContext('2d');
var ballRadius = 10;
var x = canvas.width/2;
var y = canvas.height/2;
var paddleWidth = 10;
var paddleHeight = 100;
var paddleXR = canvas.width-paddleWidth;
var paddleYR = (canvas.height-paddleHeight)/2;
var paddleXL = 0;
var paddleYL = (canvas.height-paddleHeight)/2;
var scoreR = 0;
var scoreL = 0;
var upRight = false;
var downRight = false;
var upLeft = false;
var downLeft = false;
var dx = 2;
var dy = -2;
var squareHtWth = 10;
var circleRad = 6;
var quantity = 11;

// create an array storage to hold random x,y coordinates for obstacles
var squares = [];
var circles = [];
for (s = 0; s < quantity; s++) {
    var pad = paddleWidth*2;
    squares[s] = {x:ranNum(pad, (canvas.width-pad)), y:ranNum(pad, (canvas.height-pad)), status: 1};
    circles[s]= {x:ranNum(pad, (canvas.width-pad)), y:ranNum(pad, (canvas.height-pad)), status: 1};
}

//random number function
function ranNum(min, max) {
    return Math.floor(Math.random() *(max - min + 1) + min);
}


//draw aesthetics
function drawRectangles(x, y, width, height, fillColor) {
    ctx.beginPath();
    ctx.rect(x, y, width, height);
    ctx.fillStyle = fillColor;
    ctx.fill();
    ctx.closePath();
}

function drawCircles(x, y, r, startAngle, endAngle, fillColor) {
    ctx.beginPath();
    ctx.arc(x, y, r, startAngle, endAngle);
    ctx.fillStyle = fillColor;
    ctx.fill();
    ctx.closePath();
}

function drawCollisionSquare() {
    for (s = 0; s < quantity; s++) {
        if (squares[s].status == 1) {
            ctx.fillStyle = 'orange';
            drawRectangles(squares[s].x, squares[s].y, squareHtWth, squareHtWth);
        }
    }
}

function drawCollisionCircle(){
    for (c=0; c<quantity; c++) {
        if (circles[c].status == 1) {
            ctx.fillStyle = 'purple';
            drawCircles(circles[c].x, circles[c].y, circleRad, 0, Math.PI * 2);
        }
    }
}

function drawBall() {
    ctx.fillStyle = 'grey';
    drawCircles(x, y, ballRadius, 0, Math.PI*2);
}

function drawPaddleR() {
    ctx.fillStyle = 'grey';
    drawRectangles(paddleXR, paddleYR, paddleWidth, paddleHeight);
}
function drawPaddleL() {
    ctx.fillStyle = 'grey';
    drawRectangles(paddleXL, paddleYL, paddleWidth, paddleHeight);
}

function scoreBoard(){
    ctx.font = "12px Arial";
    ctx.fillStyle = "grey";
    ctx.fillText("Right Score: " + scoreR, canvas.width-85, 20);
    ctx.fillText("Left Score: " + scoreL, 10, 20);
}

//collision
function col(a, b) {
    var htwth = squareHtWth + 2;
    return x > a - htwth && x < a + htwth && y > b - htwth && y < b + htwth;
}

function collisionCircle() {
    for (s = 0; s < quantity; s++) {
        if (circles[s].status == 1) {
            if (col(circles[s].x, circles[s].y)) {
                if (dx > 0) {
                    dx = dx + 1;
                }
                else if (dx < 0) {
                    dx = dx - 1;
                }
                circles[s].status = 0;
            }
        }
    }
}

function collisionSquare() {
    for (s = 0; s < quantity; s++) {
        if (squares[s].status == 1) {
            if (col(squares[s].x, squares[s].y)) {
                dx = -dx;
                squares[s].status = 0;
            }
        }
    }
}


function keyDownHandler(e) {
    if (e.keyCode == 38) {
        upRight = true;
    }
    else if (e.keyCode == 40) {
        downRight = true;
    }
    else if (e.keyCode == 87) {
        upLeft = true;
    }
    else if (e.keyCode == 83) {
        downLeft = true;
    }
}

function keyUpHandler(e) {
    if (e.keyCode == 38) {
        upRight = false;
    }
    else if (e.keyCode == 40) {
        downRight = false;
    }
    else if (e.keyCode == 87) {
        upLeft = false;
    }
    else if (e.keyCode == 83) {
        downLeft = false;
    }
}

// End game stats
function endGame() {
    var total = 'Score Right:' + scoreR + '\nScore Left: ' + scoreL;
    if (scoreR > scoreL){
        window.alert(total + '\n Player Right you win!');
        document.location.reload();
    }
    else if (scoreL > scoreR) {
        window.alert(total + '\n Player Left you win!');
        document.location.reload();
    }
    else if (scoreL == scoreR){
        window.alert(total + ' \nTie ' );
        document.location.reload();
    }
}


//  main function
function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawBall();
    drawPaddleR();
    drawPaddleL();
    scoreBoard();
    drawCollisionSquare();
    drawCollisionCircle();
    collisionSquare();
    collisionCircle();



//   logic to keep ball in height bounds
    if (y+dy > canvas.height-ballRadius || y+dy < ballRadius) {
        dy = -dy;
    }

//  logic left paddle bounds + score
    else if (x < ballRadius) {
        if (y > paddleYL - ballRadius && y < paddleYL + paddleHeight + ballRadius) {
            dx = -dx;
            scoreL++;
        }
        else {
            return endGame();
        }
    }


//  logic right paddle bounds + score
    else if (x > canvas.width-ballRadius) {
        if (y > paddleXL - ballRadius && y < paddleYL + paddleHeight + (ballRadius/2)) {
            dx = -dx;
            scoreR++;
        }
        else {
            return endGame();
        }
    }
//    paddle movemvent logic
    if (upRight && paddleYR > 0) {
        paddleYR += -7;
    }
    if(downRight && paddleYR < canvas.height-paddleHeight) {
        paddleYR += 7
    }
//    left paddle logic
    if (upLeft && paddleYL > 0) {
        paddleYL -= 7
    }
    if (downLeft && paddleYL < canvas.height- paddleHeight) {
        paddleYL += 7
    }

// move ball
    x += dx;
    y += dy;


requestAnimationFrame(draw);
}

document.addEventListener('keydown', keyDownHandler, false);
document.addEventListener('keyup', keyUpHandler, false);

draw();




</script>

</body>